<!DOCTYPE HTML>
<html lang="en">
    <head>
        <title>Comics</title>
        <link rel="stylesheet" href="css/main.css">
        <style>
            button {
                padding: 2px;
                margin: 4px;
                font-size: 16px;
            }

            label {
                align-self: center;
                margin-right: 4px;
            }
        </style>
    </head>
    <body>
        <h1 style="margin-top: 60px;">Comics</h1>

        <div class="centered">
            <label for="comic">Comic:</label>
            <select id="comic" onchange="comicSelected(this.value)"></select>
        </div>

        <div class="centered">
            <button onclick="first()">First</button>
            <button onclick="prev()">Prev</button>

            <label for="page">Page:</label>
            <select id="page" onchange="pageSelected(this.value)"></select>

            <button onclick="next()">Next</button>
            <button onclick="last()">Last</button>
        </div>

        <div class="centered">
            <img id="display" onclick="nextPage()"/>
        </div>

        <script>
            var comics = [["Comic 1", "comic1"], ["Comic 2", "comic2"]]
            
            var pages = {
                comic1: [["1", "comic1-1.png"], ["2", "comic1-2.png"], ["3", "comic1-3.png"]],
                comic2: [["1", "comic2-1.png"], ["2", "comic2-2.png"]]
            }

            function setup() {
                var comicSelect = document.getElementById("comic");
                
                comics.forEach(element => {
                    var option = document.createElement("option");
                    option.text = element[0];
                    option.value = element[1];
                    comicSelect.add(option);
                });

                comicSelected(document.getElementById("comic").options[0].value);
            }

            function comicSelected(value) {
                pageList = pages[value];
                
                pageSelect = document.getElementById("page");

                for (var i = pageSelect.options.length - 1; i >= 0; i--) {
                    pageSelect.remove(i);
                }

                pageList.forEach(element => {
                    var option = document.createElement("option");
                    option.text = element[0];
                    option.value = element[1];
                    pageSelect.add(option);
                });

                pageSelected(document.getElementById("page").options[0].value);
            }
            
            function pageSelected(value) {
                var comic = document.getElementById("comic").value;

                var page = "comics/" + value;
                document.getElementById("display").src = page;
            }

            function nextPage() {
                var pageSelect = document.getElementById("page");
                var pages = [];

                for (var i = 0; i < pageSelect.options.length; i++) {
                    pages.push(pageSelect.options[i].value);
                }

                var curr = pageSelect.value;
                var currIndex = pages.findIndex((element) => element == curr);

                if (currIndex < pages.length - 1) {
                    var nextIndex = currIndex + 1;
                    var next = pages[nextIndex];

                    pageSelect.value = next;

                    pageSelected(document.getElementById("page").value);
                }
            }

            function first() {
                var pageSelect = document.getElementById("page");

                pageSelect.value = pageSelect.options[0].value;
                pageSelected(pageSelect.options[0].value);
            }

            function prev() {
                var pageSelect = document.getElementById("page");

                var pages = [];

                for (var i = 0; i < pageSelect.options.length; i++) {
                    pages.push(pageSelect.options[i].value);
                }

                var currIndex = pages.findIndex((element) => element == pageSelect.value);

                if (currIndex > 0) {
                    var index = currIndex - 1;
                
                    pageSelect.value = pageSelect.options[index].value;
                    pageSelected(pageSelect.options[index].value);
                }
            }

            function next() {
                var pageSelect = document.getElementById("page");

                var pages = [];

                for (var i = 0; i < pageSelect.options.length; i++) {
                    pages.push(pageSelect.options[i].value);
                }

                var currIndex = pages.findIndex((element) => element == pageSelect.value);

                if (currIndex < pageSelect.length - 1) {
                    var index = currIndex + 1;
                
                    pageSelect.value = pageSelect.options[index].value;
                    pageSelected(pageSelect.options[index].value);
                }
            }

            function last() {
                var pageSelect = document.getElementById("page");
                var index = pageSelect.options.length - 1;
                
                pageSelect.value = pageSelect.options[index].value;
                pageSelected(pageSelect.options[index].value);
            }

            setup();
        </script>
    </body>
</html>